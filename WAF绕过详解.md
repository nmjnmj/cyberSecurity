# WAF绕过

WAF防护原理详解
目录扫描绕过waf
手工注入绕过waf
sqlmap注入绕过waf
编写sqlmap绕过waf脚本
过WAF一句话编写讲解
菜刀连接绕过WAF
webshell上传绕过WAF
提权绕过waf

## WAF绕过原理详解

知己知彼百战不殆

了解waf防护原理
查看waf防护位置
熟悉防护规则
了解防护机制
查看拦截事件阈值

安全狗

# 目标扫描绕过waf

两种方式：

第一：修改客户端ip
第二：减慢扫描速度
第三：通过代理欺骗waf

# 手工注入过waf

搭建测试环境
了解绕过原理
熟悉常见绕过构造语句
构造绕过测试语句

## 注入绕过方法

1 大小写变种
2 使用SQL注释
3 使用URL编码
4 使用空字节
5 使用嵌套过剥离
6 使用非标准入口点
7 避开自定义过滤器

### 大小写转换

使用起来最简单，效果现在来说不太显著

比如：
and 1=2
AnD 1=3

### 使用注释

使用起来简单，效果一般
union select 1,2,3,4,5,6 from admin
注释完
/**/union/**/select/**/1,2,3,4,5,6 from admin
/**/un/**/io/**/n/**/sel/**/ec/**/t/**/1,2,3,4,5,6 from admin
第二种注释
/*!and*/ 1=2 效果显著

### url编码

正常编码
' 为 %27
/ =%2f *==%2a %=%25
/**/==%252f%252a*/

### 使用空字节

一些过滤器在处理输入时，如果碰到空字节就会停止处理。
我们通常也会利用空字节进行绕过过滤器
如：
id=1 %00 and 1=2

### 利用嵌套剥离

有些过滤器会从用户的输入中进行剥离一些敏感的函数，那我们可以通过函数的嵌套进行绕过一次剥离
selselectect
剥离后
select

### 使用非标准入门点

说白了就是攻击他的冷门
需要自己去挖掘
一些连过滤器都没发现的注入点即可

### 避开自定义过滤器

一些过滤器他所过滤的字符串都是事先写入写好的
只要我们输入的语法和他们过滤的不匹配即可绕过
比如 and
转换为a+nd
a%nd
'a'nd
%A0and

### 总结编写绕过语句

利用注释
/*^ABC^*/

包含关键字
/*!/*!/*!union*/
变换提交方式
将get改成post或者cookie提交

### sqlmap tamper利用

Symboliclogical.py
space2mssqlhash.py
appendnullbyte.py

利用修改tamper绕过waf

### 实战编写过waf一句话

编写过狗一句话思路：
利用可变变量
$a=b
$b=c
$$a=c
利用函数
利用判断语句
利用编码

### 突破waf拦截菜刀连接

可以使用最新版菜刀
中国蚁剑客户端
可以使用过狗菜刀+中转脚本

### 上传绕过waf

上传突破禁止上传php我呢见
第一：文件包含
第二：双文件上传突破限制
第三：修改上传参数

### 提权过waf

通过程序读密码
利用waf绕过神器
利用exp读hash
将用户添加到远程桌面组，并且给目录降权
利用第三方软件提权
system 把安全狗服务停止，重启服务器